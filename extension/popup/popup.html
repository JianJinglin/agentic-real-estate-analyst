<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rancho - Property Analysis</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ  Rancho</h1>
      <p>Property Cashflow Analysis Tool</p>
    </header>

    <div class="tabs">
      <button class="tab active" data-tab="settings">âš™ï¸ Settings</button>
      <button class="tab" data-tab="assumptions">ğŸ“Š Parameters</button>
      <button class="tab" data-tab="help">â“ Help</button>
    </div>

    <!-- Settings Tab -->
    <div class="tab-content active" id="settings">
      <div class="section">
        <h3>ğŸ”— GitHub Connection</h3>
        <div class="form-group">
          <label>GitHub Token</label>
          <input type="password" id="github-token" placeholder="ghp_xxxx...">
          <small>Personal Access Token with repo permission</small>
        </div>
        <div class="form-group">
          <label>Repository (owner/repo)</label>
          <input type="text" id="github-repo" placeholder="JianJinglin/agentic-real-estate-analyst">
        </div>
        <div class="form-group">
          <label>CSV File Path</label>
          <input type="text" id="github-path" placeholder="data/properties.csv">
        </div>
        <button id="save-github" class="btn-primary">ğŸ’¾ Save Config</button>
        <div id="github-status" class="status"></div>
      </div>
    </div>

    <!-- Assumptions Tab -->
    <div class="tab-content" id="assumptions">
      <div class="section">
        <h3>ğŸ’° Loan Parameters</h3>
        <div class="form-group">
          <label>Down Payment (%)</label>
          <input type="number" id="down-payment" value="3.5" step="0.5" min="0" max="100">
          <small>Default: 3.5% for FHA loan</small>
        </div>
        <div class="form-group">
          <label>Interest Rate (%)</label>
          <input type="number" id="interest-rate" value="6.0" step="0.125" min="0">
          <small>Annual mortgage interest rate</small>
        </div>
        <div class="form-group">
          <label>Loan Term (years)</label>
          <input type="number" id="loan-term" value="30" min="1" max="40">
        </div>
        <div class="form-group">
          <label>PMI Rate (% of loan/year)</label>
          <input type="number" id="pmi-rate" value="0.75" step="0.05" min="0">
          <small>Only applied when LTV > 80%. Formula: loan Ã— 0.75% / 12</small>
        </div>
      </div>

      <div class="section">
        <h3>ğŸ¦ Expense Parameters</h3>
        <div class="form-group">
          <label>Property Tax Rate (%/year)</label>
          <input type="number" id="property-tax" value="2.5" step="0.1" min="0">
          <small>Annual property tax as % of home value</small>
        </div>
        <div class="form-group">
          <label>Insurance Rate (%/year)</label>
          <input type="number" id="insurance-rate" value="0.3" step="0.05" min="0">
          <small>Default: 0.3% = home value Ã— 0.003 / 12 per month</small>
        </div>
        <div class="form-group">
          <label>Maintenance (% of monthly rent)</label>
          <input type="number" id="maintenance-percent" value="5" step="1" min="0">
          <small>Monthly maintenance reserve as % of rent</small>
        </div>
        <div class="form-group">
          <label>Property Management (% of monthly rent)</label>
          <input type="number" id="management-percent" value="10" step="1" min="0">
          <small>Property manager fee as % of rent</small>
        </div>
        <div class="form-group">
          <label>Vacancy Rate (% of rent)</label>
          <input type="number" id="vacancy-rate" value="0" step="1" min="0" max="100">
          <small>Expected vacancy loss. 0% = assume always rented, 5% = ~18 days/year vacant</small>
        </div>
      </div>

      <div class="section">
        <h3>ğŸ“ˆ Tax & Returns</h3>
        <div class="form-group">
          <label>Income Tax Rate (%)</label>
          <input type="number" id="income-tax-rate" value="10" step="1" min="0" max="50">
          <small>Low tax bracket for cashflow calculation</small>
        </div>
        <div class="form-group">
          <label>High Income Tax Rate (%)</label>
          <input type="number" id="high-income-tax-rate" value="30" step="1" min="0" max="50">
          <small>High tax bracket for comparison</small>
        </div>
        <div class="form-group">
          <label>Annual Appreciation Rate (%)</label>
          <input type="number" id="appreciation-rate" value="3" step="0.5" min="0" max="20">
          <small>Expected annual home value increase</small>
        </div>
      </div>

      <button id="save-assumptions" class="btn-primary">ğŸ’¾ Save Parameters</button>
      <button id="reset-assumptions" class="btn-secondary">ğŸ”„ Reset to Defaults</button>
      <div id="assumptions-status" class="status"></div>
    </div>

    <!-- Help Tab -->
    <div class="tab-content" id="help">
      <div class="section">
        <h3>ğŸ“– How to Use</h3>
        <ol>
          <li>Open a Zillow property detail page</li>
          <li>Click the "ğŸ  Rancho" button on the page</li>
          <li>View the cashflow analysis results</li>
          <li>Click "Add to My Excel" to save to GitHub</li>
        </ol>
      </div>

      <div class="section">
        <h3>ğŸ”‘ Get GitHub Token</h3>
        <ol>
          <li>Visit <a href="https://github.com/settings/tokens" target="_blank">GitHub Settings > Tokens</a></li>
          <li>Click "Generate new token (classic)"</li>
          <li>Check the "repo" permission</li>
          <li>Copy the generated Token</li>
        </ol>
      </div>

      <div class="section">
        <h3>ğŸ“Š Calculation Formulas</h3>
        <p><strong>PMI</strong> = IF(LTV > 80%, loan Ã— 0.75% / 12, 0)</p>
        <p><strong>Monthly Expenses</strong> = Mortgage + Tax + Insurance + Maint + Mgmt + HOA + PMI</p>
        <p><strong>Cashflow</strong> = Rent - Expenses - Income Tax</p>
        <p><strong>Cashflow APY</strong> = Annual Cashflow / Down Payment Ã— 100%</p>
        <p><strong>5-Year APY</strong> = (Cashflow + Appreciation) / Down Payment Ã— 100%</p>
        <p><strong>Cap Rate</strong> = Annual NOI / Price Ã— 100%</p>
      </div>
    </div>

    <footer>
      <p>v1.1.0 | Made with â¤ï¸</p>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>
